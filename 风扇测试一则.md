## 风扇测试一则

### 风扇官方参数
---
![intel风扇](http://7xtauc.com1.z0.glb.clouddn.com/intel%E9%A3%8E%E6%89%87.png)  

品牌: intel英特尔  
规格: 25X25X10MM  
电压: DC5V  
电流: 0.14A  
转速: 2300~10000RPM  
风量: 0.7~2.8CFM  
噪音: 11~26dba  
接线方式: 原装4线接头 支持测速支持PWM温控 可单独接两线使用  
轴承: 双滚珠轴承  
工作寿命: 75000小时  
[购买链接](https://item.taobao.com/item.htm?spm=a230r.1.14.53.QtoT5x&id=530707717250&ns=1&abbucket=11#detail&qq-pf-to=pcqq.c2c)


### 引线说明  
---

| 颜色          | 功能           | 注意事项  |  
| ------------- |:-------------:| :----- |  
| 黄     | +,  VCC | 建议输入电压3.2~5.5V |  
| 黑      | -, GND      | GND |  
| 蓝 | PWM   | 悬空默认高电平，电压比VCC低0.5V， 风机全速运转， 理论启动占空比3.2/5.0*100%=64%, 如果需要更低转速, 可以先高速或满速运转以启动, 然后再降低占空比 |  
| 绿 | SENSOR  |  转速指示, 每转一圈输出一个方波. 开漏输出, 需要外接10kΩ的上拉电阻到VCC, 波形为50%占空比的方波. |   

### 风扇测试(蓝线PWM悬空)  
---
![fan_test1](http://7xtauc.com1.z0.glb.clouddn.com/fan_test1.png)  
测试数据（蓝线PWM悬空, 全速运转）如下:  

| 电压(V) | 电流(A) | 绿线频率(Hz) |
| --------|:------:| :-----------:|
| 3.2     | 0.058 |   280 |
| 3.6     | 0.075 |   330 |
| 4.0     | 0.086 |   370 |
| 5.0     | 0.112 |   460 |

Hz， 即每秒转的圈数？。
可以看到，如果不使用PWM， 最低的建议启动电压3.2V对应的转速也要超过额定转速的一半。当然， 也可以使用高电压启动， 然后逐步降压的方式来降低转速。

### PWM测试
---
风扇直接通过USB供电，黄黑线分别接VCC和GND,  PWM线（蓝线）接单片机的PWM输出口， SENSOR线（绿线）接了一个10kΩ的上拉电阻到VCC. 万用表打到交流电压档， 然后点击右上角 Hz % 按钮，可以测量频率, 黑表笔和红表笔分别接GND 和 SENSOR线（绿线）. 测试图片如下：
![fan_test2](http://7xtauc.com1.z0.glb.clouddn.com/fan_test2.png)  
MCU是某处找的闲置片子， 手头又暂时没有板子，就用烙铁在洞洞板上撸了个最小系统：
![mcu](http://7xtauc.com1.z0.glb.clouddn.com/MCU.png)

使用的8位PWM， 能维持运转的最低转速的占空比为(256-213)/256 * 100% = 16.8%. 如果换用STM32，使用12位PWM，应该会有更精确的调节。插上USB，单片机初始化之前， 风扇会有短时间的全速运转， 然后单片机初始化完成， PWM输出， 风扇开始减速并稳定在5.7~7.7 Hz之间。

注意： 此为空载状态， 如果风扇加上负载需要重新调节PWM. 如果负载不稳定，需要转速相对稳定，PID算法应该是少不了的。(20160916)
